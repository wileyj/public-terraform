refactor of terraform using modular design principles